/*! Cupboard v0.0.3 */
this.JST=this.JST||{},this.JST["account/edit/templates/form.html"]=function(obj){obj||(obj={});var __t,__p="",__e=_.escape;with(obj)__p+='<form class="form-horizontal center">\n  <div id="js-errors" class="hide">\n    <div class="alert alert-error">\n      <button type="button" class="close" data-dismiss="alert">×</button>\n      <span></span>\n    </div>\n  </div>\n  <div class="alert alert-success hide">\n    '+(null==(__t=Lang.account_saved)?"":__t)+'\n  </div>\n  <div class="control-group">\n    <label class="control-label" for="first_name">'+(null==(__t=Lang.account_first_name)?"":__t)+'</label>\n    <div class="controls">\n      <input type="text" id="first_name" name="first_name" placeholder="'+(null==(__t=Lang.account_first_name)?"":__t)+'">\n    </div>\n  </div>\n  <div class="control-group">\n    <label class="control-label" for="last_name">'+(null==(__t=Lang.account_last_name)?"":__t)+'</label>\n    <div class="controls">\n      <input type="text" id="last_name" name="last_name" placeholder="'+(null==(__t=Lang.account_last_name)?"":__t)+'">\n    </div>\n  </div>\n  <div class="control-group">\n    <label class="control-label" for="email">'+(null==(__t=Lang.account_email)?"":__t)+'</label>\n    <div class="controls">\n      <input type="text" id="email" name="email" placeholder="'+(null==(__t=Lang.account_email)?"":__t)+'">\n    </div>\n  </div>\n  <div class="control-group">\n    <label class="control-label" for="password">'+(null==(__t=Lang.account_password)?"":__t)+'</label>\n    <div class="controls">\n      <input id="password" type="password" name="password" value="">\n      <span class="help-block">'+(null==(__t=Lang.account_password_keep)?"":__t)+'</span>\n    </div>\n  </div>\n  <div class="control-group">\n    <div class="controls">\n      <button type="submit" class="btn save">'+(null==(__t=Lang.account_save)?"":__t)+"</button>\n    </div>\n  </div>\n</form>\n";return __p},this.JST["account/list/templates/grid.html"]=function(obj){obj||(obj={});var __t,__p="",__e=_.escape;with(obj)__p+='<div class="holder"></div>\n<button class="btn add-new"><i class="icon-plus-sign"></i> '+(null==(__t=Lang.account_add_new)?"":__t)+"</button>";return __p},this.JST["account/list/templates/item.html"]=function(obj){function print(){__p+=__j.call(arguments,"")}obj||(obj={});var __t,__p="",__e=_.escape,__j=Array.prototype.join;with(obj)__p+='<a href="#" class="details">\n  <img src="" class="avatar img-polaroid" width="100" height="100">\n  '+(null==(__t=first_name)?"":__t)+" "+(null==(__t=last_name)?"":__t)+"\n</a>\n",canDelete()&&(__p+='\n  <a href="#" class="delete" title="'+(null==(__t=Lang.account_delete)?"":__t)+'"><i class="icon-trash"></i></a>\n'),__p+="\n";return __p},this.JST["account/new/templates/form.html"]=function(obj){obj||(obj={});var __t,__p="",__e=_.escape;with(obj)__p+='<form class="form-horizontal center">\n  <div id="js-errors" class="hide">\n    <div class="alert alert-error">\n      <button type="button" class="close" data-dismiss="alert">×</button>\n      <span></span>\n    </div>\n  </div>\n  <div class="alert alert-success hide">\n    '+(null==(__t=Lang.account_saved)?"":__t)+'\n  </div>\n  <div class="control-group">\n    <label class="control-label" for="first_name">'+(null==(__t=Lang.account_first_name)?"":__t)+'</label>\n    <div class="controls">\n      <input type="text" id="first_name" name="first_name" placeholder="'+(null==(__t=Lang.account_first_name)?"":__t)+'">\n    </div>\n  </div>\n  <div class="control-group">\n    <label class="control-label" for="last_name">'+(null==(__t=Lang.account_last_name)?"":__t)+'</label>\n    <div class="controls">\n      <input type="text" id="last_name" name="last_name" placeholder="'+(null==(__t=Lang.account_last_name)?"":__t)+'">\n    </div>\n  </div>\n  <div class="control-group">\n    <label class="control-label" for="email">'+(null==(__t=Lang.account_email)?"":__t)+'</label>\n    <div class="controls">\n      <input type="text" id="email" name="email" placeholder="'+(null==(__t=Lang.account_email)?"":__t)+'">\n    </div>\n  </div>\n  <div class="control-group">\n    <label class="control-label" for="password">'+(null==(__t=Lang.account_password)?"":__t)+'</label>\n    <div class="controls">\n      <input id="password" type="password" name="password" value="">\n    </div>\n  </div>\n  <div class="control-group">\n    <label class="control-label" for="password_confirm">'+(null==(__t=Lang.account_password_confirm)?"":__t)+'</label>\n    <div class="controls">\n      <input id="password_confirm" type="password" name="password_confirm" value="">\n    </div>\n  </div>\n  <div class="control-group">\n    <div class="controls">\n      <button type="submit" class="btn save">'+(null==(__t=Lang.account_add)?"":__t)+"</button>\n    </div>\n  </div>\n</form>\n";return __p},this.JST["header/list/templates/header.html"]=function(obj){obj||(obj={});var __t,__p="",__e=_.escape;with(obj)__p+='<nav>\n  <ul>\n    <li><a class="write" href="#"><i class="fa fa-plus"></i> '+(null==(__t=Lang.write)?"":__t)+'</a></li>\n    <li><a class="posts" href="#post"><i class="fa fa-list"></i> '+(null==(__t=Lang.posts)?"":__t)+'</a></li>\n    <li><a class="accounts" href="#accounts"><i class="fa fa-user"></i> '+(null==(__t=Lang.accounts)?"":__t)+'</a></li>\n    <li><a href="'+(null==(__t=logoutUrl())?"":__t)+'"><i class="fa fa-power-off"></i> '+(null==(__t=Lang.logout)?"":__t)+"</a></li>\n  </ul>\n</nav>\n";return __p},this.JST["post/_base/templates/form.html"]=function(obj){obj||(obj={});var __t,__p="",__e=_.escape;with(obj)__p+='    <form>\n        <input class="js-active" id="active" name="active" type="hidden" value="1">\n    </form>\n    <div class="field pull-right">\n        <div class="btn-group pull-right">\n            <button class="btn btn-sm btn-primary publish">'+(null==(__t=submitBtnText())?"":__t)+'</button> <button class=\n            "btn btn-sm btn-primary dropdown-toggle" data-toggle="dropdown" type="button"><span class="caret"></span>\n            <span class="sr-only">Toggle Dropdown</span></button>\n            <ul class="dropdown-menu" role="menu">\n                <li>\n                    <a class="js-status" data-action="publish" href="#">'+(null==(__t=Lang.post_publish)?"":__t)+'</a>\n                </li>\n                <li>\n                    <a class="js-status" data-action="draft" href="#">'+(null==(__t=Lang.post_save)?"":__t)+'</a>\n                </li>\n                <li class="divider"></li>\n                <li>\n                    <a class="preview" href="'+(null==(__t=previewUrl())?"":__t)+'" target="_blank">'+(null==(__t=Lang.post_preview)?"":__t)+'\n                    <i class="icon-external-link"></i></a>\n                </li>\n            </ul>\n        </div>\n    </div>\n    <form action="/admin/posts/edit/{{ $post->id }}" class="post" id="post-form" method="post" name=\n    "post-form" role="form">\n        <div class="content-area">\n            <textarea id="content" name="content" placeholder="'+(null==(__t=Lang.post_content)?"":__t)+'"></textarea>\n        </div>\n        <div class="form-group">\n            <input class="form-control input-lg" id="title" name="title" placeholder="'+(null==(__t=Lang.post_title)?"":__t)+'" type=\n            "text">\n        </div>\n        <div class="form-group">\n            <input class="form-control" id="slug" name="slug" placeholder="'+(null==(__t=Lang.post_slug)?"":__t)+'" type="text">\n        </div>\n        <div class="form-group author">\n            <select class="form-control" id="js-user" name="user_id">\n                </select>\n        </div>\n        <div class="form-group">\n            <input class="form-control js-date" id="publish_date" name="date" placeholder=\n            "'+(null==(__t=Lang.post_publish_date)?"":__t)+'" type="text" value="">\n        </div>\n        <div class="form-group">\n            <label for="tags">'+(null==(__t=Lang.post_tags)?"":__t)+'</label> <input class="tags" id="js-tags" name="tags" placeholder=\n            "'+(null==(__t=Lang.post_tags)?"":__t)+'" style="width: 100%" type="text" value="">\n        </div>\n    </form>\n    <div id="film-form" style="display: none">\n        <form class="form-inline">\n            <label for="date">Video URL</label><br>\n            <input class="form-control js-film" id="film" name="date" placeholder="http://youtube.com/" type="text"\n            value=""> <button class="btn js-submitfilm btn-sm">'+(null==(__t=Lang.post_publish_date_set)?"":__t)+"</button>\n        </form>\n    </div>\n";return __p},this.JST["post/list/templates/empty.html"]=function(obj){obj||(obj={});var __t,__p="",__e=_.escape;with(obj)__p+='<div class="well no-posts">\n  <h3>You do not have any drafts.</h3>\n  <p class="lead">\n    quotes go here.\n  </p>\n\n  <a href="#" class="btn btn-default btn-lg">Start Writing</a>\n</div>';return __p},this.JST["post/list/templates/grid.html"]=function(obj){obj||(obj={});var __t,__p="",__e=_.escape;with(obj)__p+='<div class="page-header">\n  <ul class="nav nav-pills pull-right">\n    <li class="active js-filter" data-type="draft"><a href="#post/draft"><i class="fa fa-edit"></i> &nbsp; Drafts</a></li>\n    <li class="js-filter" data-type="scheduled"><a href="#post/scheduled"><i class="fa fa-calendar"></i> &nbsp; Scheduled</a></li>\n    <li class="js-filter" data-type="published"><a href="#post/published"><i class="fa fa-laptop"></i> &nbsp; Published</a></li>\n  </ul>\n  <h1>Your Posts </h1>\n</div>\n\n<form class="filter form-inline hidden-xs" role="form">\n  <div class="form-group">\n    <input type="text" class="form-control filter" id="js-filter" name="filter" placeholder="Filter">\n  </div>\n</form>\n<table class="table table-hover">\n\t<thead>\n\t\t<tr>\n\t\t\t<th>'+(null==(__t=Lang.post_title)?"":__t)+"</th>\n\t\t\t<th>"+(null==(__t=Lang.post_published)?"":__t)+'</th>\n\t\t</tr>\n\t</thead>\n\t<tbody></tbody>\n</table>\n\n<div class="well no-posts">\n  <h3>You do not have any <span>draft</span> posts.</h3>\n  <p class="lead js-quote"></p>\n  <a href="#" class="btn btn-default btn-lg">Start Writing</a>\n</div>\n';return __p},this.JST["post/list/templates/item.html"]=function(obj){obj||(obj={});var __t,__p="",__e=_.escape;with(obj)__p+='<td class="title">\n  <div class="actions">\n    <a href="#" class="delete" title="'+(null==(__t=Lang.post_delete)?"":__t)+'"><i class="fa fa-trash"></i></a>\n    <a href="#" target="_blank" title="Preview" class="preview"><i class="fa fa-search-plus"></i></a>\n  </div>\n  <a href="#" class="details">'+(null==(__t=title)?"":__t)+'</a>\n</td>\n<td class="date js-format-date" data-date="'+(null==(__t=publish_date)?"":__t)+'">'+(null==(__t=publish_date)?"":__t)+"</td>\n\n";return __p},function(Backbone){var a,b;return b=Backbone.sync,Backbone.sync=function(c,d,e){var f;if(null==e&&(e={}),_.defaults(e,{beforeSend:_.bind(a.beforeSend,d),complete:_.bind(a.complete,d)}),f=b(c,d,e),!d._fetch&&"read"===c)return d._fetch=f},a={beforeSend:function(){return this.trigger("sync:start",this)},complete:function(){return this.trigger("sync:stop",this)}}}(Backbone),$.fn.avatar=function(a,b){return null==b&&(b=28),$(this).attr("src","//www.gravatar.com/avatar/"+md5(a.toLowerCase())+"?s="+2*b)},$.fn.formatDates=function(){var a;return a=$(this),a.each(function(a,b){var c,d,e,f;return d=$(this),c=d.data("format"),e=d.data("date"),"undefined"==typeof c&&(c="MMM Do YYYY, hh:mma"),f=isNaN(e)?moment(e,"YYYY-MM-DD HH:mm:ss"):moment.unix(e),d.text(f.local().format(c))})},$.fn.fillJSON=function(a){var b,c,d,e;b=$(this),e=[];for(c in a)d=a[c],"active"!==c?e.push(b.find("[name='"+c+"']").val(d)):e.push(void 0);return e},$.fn.showAlert=function(a,b,c){var d,e;return d=$(this),e="<div class='alert alert-block alert-dismissable "+c+'\'>    <button type="button" class="close" data-dismiss="alert" aria-hidden="true">&times;</button>    <strong>'+a+"</strong> "+b+"  </div>",d.html(e).fadeIn()},function(Backbone){return _.extend(Backbone.Marionette.Application.prototype,{navigate:function(a,b){return null==b&&(b={}),Backbone.history.navigate(a,b)},getCurrentRoute:function(){var a;return a=Backbone.history.fragment,_.isEmpty(a)?null:a},startHistory:function(){if(Backbone.history)return Backbone.history.start()},register:function(a,b){var c;return null==(c=this._registry)&&(this._registry={}),this._registry[b]=a},unregister:function(a,b){return delete this._registry[b]},resetRegistry:function(){var a,b,c,d,e;d=this.getRegistrySize(),e=this._registry;for(b in e)a=e[b],a.region.destroy();return c="There were "+d+" controllers in the registry, there are now "+this.getRegistrySize(),this.getRegistrySize()>0?console.warn(c,this._registry):console.log(c)},getRegistrySize:function(){return _.size(this._registry)}})}(Backbone);var __hasProp={}.hasOwnProperty,__extends=function(a,b){function c(){this.constructor=a}for(var d in b)__hasProp.call(b,d)&&(a[d]=b[d]);return c.prototype=b.prototype,a.prototype=new c,a.__super__=b.prototype,a};!function(Backbone,a){return a.Region.Dialog=function(a){function b(){_.extend(this,Backbone.Events)}return __extends(b,a),b.prototype.onShow=function(a){var b,c=this;return this.setupBindings(a),b=this.getDefaultOptions(_.result(a,"dialog")),this.$el.on("hidden",function(){return c.destroyDialog()}),this.$el.on("shown",function(){return Snappy.execute("dialog:shown",a)}),this.$el.modal(b)},b.prototype.getDefaultOptions=function(a){return null==a&&(a={}),_.defaults(a,{backdrop:!0,keyboard:!0,show:!0,remote:!1,shown:null})},b.prototype.setupBindings=function(a){return this.listenTo(a,"dialog:destroy",this.destroyDialog)},b.prototype.destroyDialog=function(){return this.stopListening(),this.destroy(),this.$el.modal("hide")},b}(a.Region)}(Backbone,Marionette),Backbone.Marionette.Renderer.render=function(a,b){var c;if(c=JST[a+".html"],!c)throw"Template "+a+" not found!";return c(b)},_.mixin({stripTrailingSlash:function(a){return"/"===a.slice(-1)?a.substr(0,a.length-1):a}});var Storage;Storage=function(){function a(a){null==a&&(a={}),this.key=a.id||"new"}return a.prototype.getKey=function(){return"post-"+this.key},a.prototype.put=function(a,b){return null==b&&(b=3e4),$.jStorage.set(this.getKey(),a,b),$.jStorage.publish(this.getKey(),a)},a.prototype.get=function(a){return null==a&&(a={}),$.jStorage.get(this.getKey(),a)},a.prototype.destroy=function(){return $.jStorage.deleteKey(this.getKey())},a}(),this.Cupboard=function(Backbone,a){var b;return b=new Backbone.Marionette.Application,b.on("before:start",function(a){return b.environment=$("meta[name=env]").attr("content"),b.csrfToken=$("meta[name='token']").attr("content"),this.currentUser=b.request("set:current:user",a.user),this.allUsers=b.request("set:all:users",a.users),this.apiUrl=_.stripTrailingSlash(a.api_url),this.adminUrl=_.stripTrailingSlash(a.admin_url),this.blogUrl=_.stripTrailingSlash(a.blog_url)}),b.reqres.setHandler("get:current:user",function(){return b.currentUser}),b.reqres.setHandler("get:all:users",function(){return b.allUsers}),b.reqres.setHandler("get:url:api",function(){return b.apiUrl}),b.reqres.setHandler("get:url:admin",function(){return b.adminUrl}),b.reqres.setHandler("get:url:blog",function(){return b.blogUrl}),b.addRegions({headerRegion:"#header-region",topnavRegion:"#top-region",mainRegion:"#main-region",footerRegion:"footer-region"}),b.addInitializer(function(){return b.module("HeaderApp").start()}),b.reqres.setHandler("default:region",function(){return b.mainRegion}),b.commands.setHandler("register:instance",function(a,c){if("dev"===b.environment)return b.register(a,c)}),b.commands.setHandler("unregister:instance",function(a,c){if("dev"===b.environment)return b.unregister(a,c)}),b.on("start",function(){return this.startHistory()}),b}(Backbone,Marionette),this.Cupboard.module("Entities",function(a,b,Backbone,c,d,e){return b.commands.setHandler("when:fetched",function(a,b){var c;return c=e.chain([a]).flatten().pluck("_fetch").value(),d.when.apply(d,c).done(function(){return b()})})});var __hasProp={}.hasOwnProperty,__extends=function(a,b){function c(){this.constructor=a}for(var d in b)__hasProp.call(b,d)&&(a[d]=b[d]);return c.prototype=b.prototype,a.prototype=new c,a.__super__=b.prototype,a};this.Cupboard.module("Entities",function(a,b,Backbone,c,d,e){return a.Collection=function(a){function c(){return c.__super__.constructor.apply(this,arguments)}return __extends(c,a),c.prototype.initialize=function(a,b){return b||(b={}),this.bind("error",this.defaultErrorHandler),this.init&&this.init(a,b)},c.prototype.defaultErrorHandler=function(a,c){switch(c.status){case 401:return document.location.href=""+b.request("get:url:admin")+"/logout"}},c.prototype.sync=function(a,c,d){return d.headers=e.extend({"X-CSRF-Token":b.csrfToken},d.headers),Backbone.sync(a,c,d)},c}(Backbone.Collection)});var __bind=function(a,b){return function(){return a.apply(b,arguments)}},__hasProp={}.hasOwnProperty,__extends=function(a,b){function c(){this.constructor=a}for(var d in b)__hasProp.call(b,d)&&(a[d]=b[d]);return c.prototype=b.prototype,a.prototype=new c,a.__super__=b.prototype,a};this.Cupboard.module("Entities",function(a,b,Backbone,c,d,e){return a.Model=function(a){function c(){return this.saveError=__bind(this.saveError,this),this.saveSuccess=__bind(this.saveSuccess,this),c.__super__.constructor.apply(this,arguments)}return __extends(c,a),c.prototype.initialize=function(a,b){return b||(b={}),this.bind("error",this.defaultErrorHandler),this.init&&this.init(a,b)},c.prototype.defaultErrorHandler=function(a,c,e){switch(c.status){case 500:return d("#js-alert").showAlert(Lang.error,Lang.error_fivehundred,"alert-error");case 401:return document.location.href=""+b.request("get:url:admin")+"/logout"}},c.prototype.destroy=function(a){return null==a&&(a={}),this.set({_destroy:!0}),c.__super__.destroy.call(this,a)},c.prototype.isDestroyed=function(){return this.get("_destroy")},c.prototype.save=function(a,b){var d;return null==b&&(b={}),d=this.isNew(),e.defaults(b,{wait:!0,success:e.bind(this.saveSuccess,this,d,b.collection),error:e.bind(this.saveError,this)}),this.unset("_errors"),c.__super__.save.call(this,a,b)},c.prototype.saveSuccess=function(a,b){return a?(b&&b.add(this),b&&b.trigger("model:created",this),this.trigger("created",this)):(null==b&&(b=this.collection),b&&b.trigger("model:updated",this),this.trigger("updated",this))},c.prototype.saveError=function(a,b,c){if(400===b.status)return this.set({_errors:d.parseJSON(b.responseText)})},c.prototype.sync=function(a,c,d){return d.headers=e.extend({"X-CSRF-Token":b.csrfToken},d.headers),Backbone.sync(a,c,d)},c}(Backbone.Model)});var __hasProp={}.hasOwnProperty,__extends=function(a,b){function c(){this.constructor=a}for(var d in b)__hasProp.call(b,d)&&(a[d]=b[d]);return c.prototype=b.prototype,a.prototype=new c,a.__super__=b.prototype,a};this.Cupboard.module("Entities",function(a,b,Backbone,c,d,e){var f;return a.Post=function(a){function c(){return c.__super__.constructor.apply(this,arguments)}return __extends(c,a),c.prototype.urlRoot=function(){return b.request("get:url:api")+"/post"},c}(b.Entities.Model),a.PostCollection=function(c){function d(){return d.__super__.constructor.apply(this,arguments)}return __extends(d,c),d.prototype.model=a.Post,d.prototype.url=function(){return b.request("get:url:api")+"/post"},d}(b.Entities.Collection),f={getAll:function(){var b;return b=new a.PostCollection,b.fetch({reset:!0}),b},getPost:function(b){var c;return c=new a.Post({id:b}),c.fetch(),c},newPost:function(){return new a.Post}},b.reqres.setHandler("post:entities",function(){return f.getAll()}),b.reqres.setHandler("post:entity",function(a){return f.getPost(a)}),b.reqres.setHandler("new:post:entity",function(){return f.newPost()})});var __hasProp={}.hasOwnProperty,__extends=function(a,b){function c(){this.constructor=a}for(var d in b)__hasProp.call(b,d)&&(a[d]=b[d]);return c.prototype=b.prototype,a.prototype=new c,a.__super__=b.prototype,a};this.Cupboard.module("Entities",function(a,b,Backbone,c,d,e){var f;return a.Tag=function(a){function c(){return c.__super__.constructor.apply(this,arguments)}return __extends(c,a),c.prototype.urlRoot=function(){return b.request("get:url:api")+"/tag"},c}(b.Entities.Model),a.TagCollection=function(c){function d(){return d.__super__.constructor.apply(this,arguments)}return __extends(d,c),d.prototype.model=a.Tag,d.prototype.url=function(){return b.request("get:url:api")+"/tag"},d}(b.Entities.Collection),f={getAll:function(b){var c;return c=new a.TagCollection,c.fetch({reset:!0,success:function(a,d,e){if(b)return b(c)},error:function(){throw new Error("Tags not fetched")}}),c}},b.reqres.setHandler("tag:entities",function(a){return f.getAll(a)})});var __hasProp={}.hasOwnProperty,__extends=function(a,b){function c(){this.constructor=a}for(var d in b)__hasProp.call(b,d)&&(a[d]=b[d]);return c.prototype=b.prototype,a.prototype=new c,a.__super__=b.prototype,a};this.Cupboard.module("Entities",function(a,b,Backbone,c,d,e){var f;return a.User=function(a){function c(){return c.__super__.constructor.apply(this,arguments)}return __extends(c,a),c.prototype.urlRoot=function(){return b.request("get:url:api")+"/user"},c}(b.Entities.Model),a.UsersCollection=function(c){function d(){return d.__super__.constructor.apply(this,arguments)}return __extends(d,c),d.prototype.model=a.User,d.prototype.url=function(){return b.request("get:url:api")+"/user"},d}(b.Entities.Collection),f={setCurrentUser:function(b){return new a.User(b)},setAllUsers:function(b){return new a.UsersCollection(b)},getUser:function(b){var c;return c=new a.User({id:b}),c.fetch(),c},getUserEntities:function(b){var c;return c=new a.UsersCollection,c.fetch({success:function(){return b(c)}})},newUser:function(){return new a.User}},b.reqres.setHandler("set:current:user",function(a){return f.setCurrentUser(a)}),b.reqres.setHandler("set:all:users",function(a){return f.setAllUsers(a)}),b.reqres.setHandler("user:entities",function(a){return f.getUserEntities(a)}),b.reqres.setHandler("user:entity",function(a){return f.getUser(a)}),b.reqres.setHandler("new:user:entity",function(){return f.newUser()})});var __hasProp={}.hasOwnProperty,__extends=function(a,b){function c(){this.constructor=a}for(var d in b)__hasProp.call(b,d)&&(a[d]=b[d]);return c.prototype=b.prototype,a.prototype=new c,a.__super__=b.prototype,a},__slice=[].slice;this.Cupboard.module("Controllers",function(a,b,Backbone,c,d,e){return a.Base=function(a){function c(a){null==a&&(a={}),this.region=a.region||b.request("default:region"),c.__super__.constructor.call(this,a),this._instance_id=e.uniqueId("controller"),b.execute("register:instance",this,this._instance_id)}return __extends(c,a),c.prototype.destroy=function(){var a;return a=1<=arguments.length?__slice.call(arguments,0):[],delete this.region,delete this.options,c.__super__.destroy.call(this,a),b.execute("unregister:instance",this,this._instance_id)},c.prototype.show=function(a){return this.listenTo(a,"destroy",this.destroy),this.region.show(a)},c}(c.Controller)});var __hasProp={}.hasOwnProperty,__extends=function(a,b){function c(){this.constructor=a}for(var d in b)__hasProp.call(b,d)&&(a[d]=b[d]);return c.prototype=b.prototype,a.prototype=new c,a.__super__=b.prototype,a};this.Cupboard.module("Views",function(a,b,Backbone,c,d,e){return a.CollectionView=function(a){function b(){return b.__super__.constructor.apply(this,arguments)}return __extends(b,a),b.prototype.childViewEventPrefix="childview",b}(c.CollectionView)});var __hasProp={}.hasOwnProperty,__extends=function(a,b){function c(){this.constructor=a}for(var d in b)__hasProp.call(b,d)&&(a[d]=b[d]);return c.prototype=b.prototype,a.prototype=new c,a.__super__=b.prototype,a};this.Cupboard.module("Views",function(a,b,Backbone,c,d,e){return a.CompositeView=function(a){function b(){return b.__super__.constructor.apply(this,arguments)}return __extends(b,a),b.prototype.childViewEventPrefix="childview",b}(c.CompositeView)});var __hasProp={}.hasOwnProperty,__extends=function(a,b){function c(){this.constructor=a}for(var d in b)__hasProp.call(b,d)&&(a[d]=b[d]);return c.prototype=b.prototype,a.prototype=new c,a.__super__=b.prototype,a};this.Cupboard.module("Views",function(a,b,Backbone,c,d,e){return a.ItemView=function(a){function b(){return b.__super__.constructor.apply(this,arguments)}return __extends(b,a),b.prototype.fillJSON=function(a){var b,c;return null==a&&(a={}),(null!=(b=this.model)?b.isNew():void 0)?this.$("form").fillJSON(a):this.$("form").fillJSON((null!=(c=this.model)?c.toJSON():void 0)||a)},b.prototype.changeErrors=function(a,b,c){return e.isEmpty(b)?this.removeErrors():this.addErrors(b)},b.prototype.addErrors=function(a){var b,c,e;null==a&&(a={}),d("#js-errors").show().find("span").html(""+Lang.post_errors+" <ul></ul>"),e=[];for(c in a)b=a[c],e.push(this.addError(b));return e},b.prototype.addError=function(a){var b;return b=d("<li>").text(a),d("#js-errors span ul").append(b)},b.prototype.removeErrors=function(){return d("#js-errors").hide()},b}(c.ItemView)});var __hasProp={}.hasOwnProperty,__extends=function(a,b){function c(){this.constructor=a}for(var d in b)__hasProp.call(b,d)&&(a[d]=b[d]);return c.prototype=b.prototype,a.prototype=new c,a.__super__=b.prototype,a};this.Cupboard.module("Views",function(a,b,Backbone,c,d,e){return a.Layout=function(a){function b(){return b.__super__.constructor.apply(this,arguments)}return __extends(b,a),b}(c.LayoutView)});var __slice=[].slice;this.Cupboard.module("Views",function(a,b,Backbone,c,d,e){var f;return f=c.View.prototype.remove,e.extend(c.View.prototype,{remove:function(){var a,c,d=this;return a=1<=arguments.length?__slice.call(arguments,0):[],"dev"===b.environment&&console.log("removing",this),(null!=(c=this.model)&&"function"==typeof c.isDestroyed?c.isDestroyed():void 0)?this.$el.fadeOut(400,function(){return f.apply(d,a)}):f.apply(this,a)}})});var __hasProp={}.hasOwnProperty,__extends=function(a,b){function c(){this.constructor=a}for(var d in b)__hasProp.call(b,d)&&(a[d]=b[d]);return c.prototype=b.prototype,a.prototype=new c,a.__super__=b.prototype,a};this.Cupboard.module("AccountApp",function(a,b,Backbone,c,d,e){var f;return a.Router=function(a){function b(){return b.__super__.constructor.apply(this,arguments)}return __extends(b,a),b.prototype.appRoutes={accounts:"list","account/new":"new","account/edit/:id":"edit"},b}(c.AppRouter),f={list:function(){return new a.List.Controller},"new":function(){return new a.New.Controller({region:b.mainRegion})},edit:function(c,d){return new a.Edit.Controller({region:b.mainRegion,id:c,account:d})}},b.vent.on("account:clicked",function(){return b.navigate("/accounts"),f.list()}),b.vent.on("account:new:clicked",function(){return b.navigate("/account/new"),f["new"]()}),b.vent.on("account:edit:clicked",function(a){return b.navigate("/account/edit/"+a.id),f.edit(a.id,a)}),b.vent.on("account:created account:updated",function(){return d("#js-alert").showAlert("Success!","Account was successfully saved.","alert-success"),b.navigate("accounts"),f.list()}),b.addInitializer(function(){return new a.Router({controller:f})})});var __hasProp={}.hasOwnProperty,__extends=function(a,b){function c(){this.constructor=a}for(var d in b)__hasProp.call(b,d)&&(a[d]=b[d]);return c.prototype=b.prototype,a.prototype=new c,a.__super__=b.prototype,a};this.Cupboard.module("AccountApp.Edit",function(a,b,Backbone,c,d,e){return a.Controller=function(c){function d(){return d.__super__.constructor.apply(this,arguments)}return __extends(d,c),d.prototype.initialize=function(a){var c,d,e=this;return c=a.account,d=a.id,c||(c=b.request("user:entity",d)),this.listenTo(c,"updated",function(){return b.vent.trigger("account:updated",c)}),b.execute("when:fetched",c,function(){var a;return a=e.getEditView(c),e.show(a)})},d.prototype.getEditView=function(b){return new a.User({model:b})},d}(b.Controllers.Base)});var __hasProp={}.hasOwnProperty,__extends=function(a,b){function c(){this.constructor=a}for(var d in b)__hasProp.call(b,d)&&(a[d]=b[d]);return c.prototype=b.prototype,a.prototype=new c,a.__super__=b.prototype,a};this.Cupboard.module("AccountApp.Edit",function(a,b,Backbone,c,d,e){return a.User=function(a){function b(){return b.__super__.constructor.apply(this,arguments)}return __extends(b,a),b.prototype.template="account/edit/templates/form",b.prototype.className="span12",b.prototype.events={"click .save":"save"},b.prototype.modelEvents={"change:_errors":"changeErrors"},b.prototype.onRender=function(){return this.fillJSON()},b.prototype.save=function(a){var b;return a.preventDefault(),b={first_name:this.$("#first_name").val(),last_name:this.$("#last_name").val(),email:this.$("#email").val(),password:this.$("#password").val(),active:1},this.model.save(b)},b}(b.Views.ItemView)});var __hasProp={}.hasOwnProperty,__extends=function(a,b){function c(){this.constructor=a}for(var d in b)__hasProp.call(b,d)&&(a[d]=b[d]);return c.prototype=b.prototype,a.prototype=new c,a.__super__=b.prototype,a};this.Cupboard.module("AccountApp.List",function(a,b,Backbone,c,d,e){return a.Controller=function(c){function d(){return d.__super__.constructor.apply(this,arguments)}return __extends(d,c),d.prototype.initialize=function(){var a,c;return a=b.request("get:all:users"),c=this.getListView(a),this.show(c),this.listenTo(c,"childview:account:delete:clicked",function(a,b){var c,d;return d=b.model,c=Lang.account_delete_confirm.replace("##first_name##",e.escape(d.get("first_name"))).replace("##last_name##",e.escape(d.get("last_name"))),!!confirm(c)&&d.destroy()})},d.prototype.getListView=function(b){return new a.Accounts({collection:b})},d}(b.Controllers.Base)});var __hasProp={}.hasOwnProperty,__extends=function(a,b){function c(){this.constructor=a}for(var d in b)__hasProp.call(b,d)&&(a[d]=b[d]);return c.prototype=b.prototype,a.prototype=new c,a.__super__=b.prototype,a};this.Cupboard.module("AccountApp.List",function(a,b,Backbone,c,d,e){return a.AccountItem=function(a){function c(){return c.__super__.constructor.apply(this,arguments)}return __extends(c,a),c.prototype.template="account/list/templates/item",c.prototype.className="account",c.prototype.triggers={"click .delete":"account:delete:clicked"},c.prototype.events={"click .details":"edit"},c.prototype.templateHelpers=function(){return{canDelete:function(){var a;return a=b.request("get:current:user"),a.id!==this.id}}},c.prototype.onShow=function(){var a;return a=this.$(".avatar"),a.avatar(this.model.get("email"),a.attr("width"))},c.prototype.edit=function(a){return a.preventDefault(),b.vent.trigger("account:edit:clicked",this.model)},c}(b.Views.ItemView),a.Accounts=function(c){function d(){return d.__super__.constructor.apply(this,arguments)}return __extends(d,c),d.prototype.template="account/list/templates/grid",d.prototype.childView=a.AccountItem,d.prototype.childViewContainer=".holder",d.prototype.className="accounts",d.prototype.events={"click .add-new":"new"},d.prototype["new"]=function(a){return a.preventDefault(),b.vent.trigger("account:new:clicked")},d}(b.Views.CompositeView)});var __hasProp={}.hasOwnProperty,__extends=function(a,b){function c(){this.constructor=a}for(var d in b)__hasProp.call(b,d)&&(a[d]=b[d]);return c.prototype=b.prototype,a.prototype=new c,a.__super__=b.prototype,a};this.Cupboard.module("AccountApp.New",function(a,b,Backbone,c,d,e){return a.Controller=function(c){function d(){return d.__super__.constructor.apply(this,arguments)}return __extends(d,c),d.prototype.initialize=function(){var a,c;return a=b.request("new:user:entity"),this.listenTo(a,"created",function(){return b.vent.trigger("account:created",a)}),c=this.getNewView(a),this.show(c)},d.prototype.getNewView=function(c){return new a.User({model:c,collection:b.request("get:all:users")})},d}(b.Controllers.Base)});var __hasProp={}.hasOwnProperty,__extends=function(a,b){function c(){this.constructor=a}for(var d in b)__hasProp.call(b,d)&&(a[d]=b[d]);return c.prototype=b.prototype,a.prototype=new c,a.__super__=b.prototype,a};this.Cupboard.module("AccountApp.New",function(a,b,Backbone,c,d,e){
return a.User=function(a){function b(){return b.__super__.constructor.apply(this,arguments)}return __extends(b,a),b.prototype.template="account/new/templates/form",b.prototype.className="span12",b.prototype.events={"click .save":"save"},b.prototype.modelEvents={"change:_errors":"changeErrors"},b.prototype.onRender=function(){return this.fillJSON()},b.prototype.save=function(a){var b;return a.preventDefault(),b={first_name:this.$("#first_name").val(),last_name:this.$("#last_name").val(),email:this.$("#email").val(),password:this.$("#password").val(),active:1},this.model.save(b,{collection:this.collection})},b}(b.Views.ItemView)}),this.Cupboard.module("DropzoneApp",function(a,b,Backbone,c,d,e){var f;return f={setupDropzone:function(){var a;return a=new Dropzone(document.body,{url:b.request("get:url:api")+"/dropzone",method:"POST",clickable:!1}),a.on("drop",function(a){return b.vent.trigger("post:new")}),a.on("error",function(a,b,c){var e;return e=d.parseJSON(b),d("#js-alert").showAlert("Error!",e.error.message,"alert-error")}),a.on("success",function(a,c){return b.vent.trigger("post:new:seed",c)})}},a.on("start",function(){return f.setupDropzone()})}),this.Cupboard.module("HeaderApp",function(a,b,Backbone,c,d,e){var f;return this.startWithParent=!1,f={list:function(){return new a.List.Controller({region:b.headerRegion})}},a.on("start",function(){return f.list()})});var __hasProp={}.hasOwnProperty,__extends=function(a,b){function c(){this.constructor=a}for(var d in b)__hasProp.call(b,d)&&(a[d]=b[d]);return c.prototype=b.prototype,a.prototype=new c,a.__super__=b.prototype,a};this.Cupboard.module("HeaderApp.List",function(a,b,Backbone,c,d,e){return a.Controller=function(b){function c(){return c.__super__.constructor.apply(this,arguments)}return __extends(c,b),c.prototype.initialize=function(){var a;return a=this.getListView(),this.show(a)},c.prototype.getListView=function(){return new a.Header},c}(b.Controllers.Base)});var __hasProp={}.hasOwnProperty,__extends=function(a,b){function c(){this.constructor=a}for(var d in b)__hasProp.call(b,d)&&(a[d]=b[d]);return c.prototype=b.prototype,a.prototype=new c,a.__super__=b.prototype,a};this.Cupboard.module("HeaderApp.List",function(a,b,Backbone,c,d,e){return a.Header=function(a){function c(){return c.__super__.constructor.apply(this,arguments)}return __extends(c,a),c.prototype.template="header/list/templates/header",c.prototype.tagName="header",c.prototype.events={"click .write":"newPost","click .accounts":"accounts"},c.prototype.onRender=function(){return this.generateAvatar(b.request("get:current:user"))},c.prototype.templateHelpers={logoutUrl:function(){return""+b.request("get:url:admin")+"/logout"}},c.prototype.generateAvatar=function(a){var b;return b=this.$(".avatar"),b.avatar(a.get("email"),b.attr("width"))},c.prototype.accounts=function(a){return a.preventDefault(),b.vent.trigger("account:clicked")},c.prototype.newPost=function(a){return a.preventDefault(),b.vent.trigger("post:new:clicked")},c}(b.Views.ItemView)});var __hasProp={}.hasOwnProperty,__extends=function(a,b){function c(){this.constructor=a}for(var d in b)__hasProp.call(b,d)&&(a[d]=b[d]);return c.prototype=b.prototype,a.prototype=new c,a.__super__=b.prototype,a};this.Cupboard.module("Views",function(a,b,Backbone,c,d,e){return a.PostView=function(a){function c(){return c.__super__.constructor.apply(this,arguments)}return __extends(c,a),c.prototype.template="post/_base/templates/form",c.prototype.className="col-md-12",c.prototype.initialize=function(a){var c=this;return b.vent.on("post:new:seed",function(a){return c.fillForm(a)}),this.tagsShown=!1,this.storage=a.storage},c.prototype.events={"click .publish":"save","click .js-toggle":"toggleDetails","click .fa-tags":"toggleTags","click .fa-user":"showUsers","click .js-status":"changeBtn","keyup #title":"localStorage","change #js-user":"localStorage"},c.prototype.modelEvents={"change:_errors":"changeErrors"},c.prototype.templateHelpers={submitBtnText:function(){return null!=this.active||"1"===this.active?Lang.post_publish:Lang.post_save},previewUrl:function(){var a;return a=this.id?this.id:"new",""+b.request("get:url:blog")+"/post/preview/"+a}},c.prototype.onShow=function(){var a=this;return this._triggerActive(),this.model.isNew()?(this.$(".js-toggle").trigger("click"),d("#title").slugIt({output:"#slug"})):(this.$("#active").val(this.model.get("active")),this.$("#"+this.model.get("type")).prop("checked",!0).parent().addClass("active"),this.$("#content").val(this.model.get("content"))),this.setUpEditor(),this.setupUsers(),this.setupFilm(),this.localStorage(),this.removeErrors(),b.request("tag:entities",function(b){return a.setUpTags(b)}),b.vent.trigger("setup:dropzone","#dropzone-attachment",this.model.get("image"))},c.prototype._triggerActive=function(){return this.model.isNew()?this:this.model.get("active")?this.$(".js-active[value=1]").trigger("click"):d(".js-active[value=0]").trigger("click")},c.prototype.setUpEditor=function(){var a,b=this;return a=["bold","italic","|","quote","unordered-list","ordered-list","|","link","image","code",{name:"film",className:"fa fa-film"},"|","undo","redo","|","preview"],this.editor=new SimpleMDE({element:document.getElementById("content"),toolbar:a}),this.imageUpload(this.editor),this.editor.codemirror.on("change",function(a,c){return b.localStorage()})},c.prototype.localStorage=function(){return this.storage.put({title:this.$("#title").val(),slug:this.$("#slug").val(),active:this.$("input[type=radio]:checked").val(),content:this.editor.codemirror.getValue(),tags:this.$("#js-tags").val(),user_id:this.$("#js-user").val(),publish_date:this.$("#publish_date").val()})},c.prototype.setupUsers=function(){var a,c,e,f;return a=this.$("#js-user"),f=b.request("get:all:users"),f.each(function(b){return a.append(d("<option></option>").val(b.id).html(b.get("first_name")+" "+b.get("last_name")))}),this.model.isNew()?(e=b.request("get:current:user"),c=this.storage.get(),(null!=c?c.user_id:void 0)?a.val(c.user_id):a.val(e.id)):a.val(this.model.get("user_id"))},c.prototype.setUpTags=function(a){return this.$("#js-tags").selectize({persist:!0,delimiter:",",maxItems:null,options:this.generateTagOptions(a),render:{item:function(a){return"<div><i class='fa fa-tag'></i> "+a.text+"</div>"},option:function(a){return"<div><i class='fa fa-tag'></i> "+a.text+"</div>"}},create:function(a){return{value:a,text:a}}})},c.prototype.generateTagOptions=function(a){var b,c;return b=function(){var b,d,e,f;for(e=a.pluck("tag"),f=[],b=0,d=e.length;b<d;b++)c=e[b],""!==c&&f.push({value:c,text:c});return f}(),this.customTags(b)},c.prototype.customTags=function(a){var b,c,e,f,g;if(c=d("#js-tags").val(),""!==c)for(g=c.split(","),e=0,f=g.length;e<f;e++)b=g[e],""!==b&&a.push({value:b,text:b});return a},c.prototype.toggleTags=function(a){return this.tagsShown?(this.$(".editor-toolbar a, .editor-toolbar i").show(),this.$(".tags-bar").hide()):(this.$(".editor-toolbar a, .editor-toolbar i").hide(),this.$(".fa-tags").show(),this.$(".tags-bar").show(),this.$("js-tags").focus()),this.tagsShown=!this.tagsShown},c.prototype.setupFilm=function(){var a=this;return this.$(".fa-film").qtip({show:{event:"click"},content:{text:d("#film-form").html()},position:{at:"right center",my:"left center",viewport:d(window),effect:!1},events:{render:function(b,c){return d(".js-submitfilm").click(function(b){var c,e;return b.preventDefault(),c=d(b.currentTarget).parent().find("input"),e=c.val(),a.attachFilm(e),c.val(""),d(".fa-film").qtip("hide")})}},hide:"unfocus"})},c.prototype.attachFilm=function(a){return a.match(/youtube.com/g)?this.bulidYoutubeIframe(a):a.match(/vimeo.com/g)?this.buildVimeoIframe(a):void 0},c.prototype.bulidYoutubeIframe=function(a){var b;return a=a.replace(/https?:\/\//,"//"),a=a.replace(/watch\?v=/,"embed/"),b='<iframe width="560" height="315" src="'+a+'" frameborder="0" allowfullscreen></iframe>',this.insert(b)},c.prototype.buildVimeoIframe=function(a){var b,c;return c=a.replace(/https?:\/\/vimeo.com\//,"//player.vimeo.com/video/"),b='<iframe src="'+c+'?title=0&amp;byline=0&amp;portrait=0" width="500" height="281" frameborder="0" webkitallowfullscreen mozallowfullscreen allowfullscreen></iframe>',this.insert(b)},c.prototype.insert=function(a){return this.editor.codemirror.replaceSelection(a)},c.prototype.save=function(a){return a.preventDefault(),this.processFormSubmit({title:this.$("#title").val(),slug:this.$("#slug").val(),active:this.$("#active").val(),content:this.editor.codemirror.getValue(),tags:this.$("#js-tags").val(),user_id:this.$("#js-user").val(),publish_date:this.$("#publish_date").val()})},c.prototype.processFormSubmit=function(a){return this.storage.destroy(),this.model.save(a,{collection:this.collection})},c.prototype.removeErrors=function(a){return this.$toggle=a,d("[data-hide]").on("click",function(){return d("."+d(this).attr("data-hide")).hide()})},c.prototype.collapse=function(a){return this.$toggle=a,this.$toggle.data("dir","up").addClass("glyphicon-chevron-right").removeClass("glyphicon-chevron-down"),this.$(".details").hide()},c.prototype.expand=function(a){return this.$toggle=a,this.$toggle.data("dir","down").addClass("glyphicon-chevron-down").removeClass("glyphicon-chevron-right"),this.$(".details").show()},c.prototype.toggleDetails=function(a){return this.$toggle=d(a.currentTarget),"up"===this.$toggle.data("dir")?this.expand(this.$toggle):this.collapse(this.$toggle)},c.prototype.changeBtn=function(a){return a.preventDefault(),this.localStorage(),"publish"===d(a.currentTarget).data("action")?(this.$(".publish").text(Lang.post_publish),this.$(".js-active").val(1)):(this.$(".publish").text(Lang.post_save),this.$(".js-active").val(0))},c.prototype.imageUpload=function(a){var c;return c={uploadUrl:b.request("get:url:api")+"/dropzone/image",allowedTypes:["image/jpeg","image/png","image/jpg","image/gif"],progressText:"![Uploading file...]()",urlText:"![file]({filename})",errorText:"Error uploading file"},inlineAttachment.editors.codemirror4.attach(a.codemirror,c)},c}(b.Views.ItemView)});var __hasProp={}.hasOwnProperty,__extends=function(a,b){function c(){this.constructor=a}for(var d in b)__hasProp.call(b,d)&&(a[d]=b[d]);return c.prototype=b.prototype,a.prototype=new c,a.__super__=b.prototype,a};this.Cupboard.module("PostApp.Edit",function(a,b,Backbone,c,d,e){return a.Controller=function(c){function d(){return d.__super__.constructor.apply(this,arguments)}return __extends(d,c),d.prototype.initialize=function(a){var c,d,e=this;return d=a.post,c=a.id,d||(d=b.request("post:entity",c)),this.storage=new Storage({id:d.id}),this.listenTo(d,"updated",function(){return e.storage.destroy(),b.vent.trigger("post:updated",d)}),b.execute("when:fetched",d,function(){var a;return a=e.getEditView(d),e.show(a)})},d.prototype.getEditView=function(b){return new a.Post({model:b,storage:this.storage})},d}(b.Controllers.Base)});var __hasProp={}.hasOwnProperty,__extends=function(a,b){function c(){this.constructor=a}for(var d in b)__hasProp.call(b,d)&&(a[d]=b[d]);return c.prototype=b.prototype,a.prototype=new c,a.__super__=b.prototype,a};this.Cupboard.module("PostApp.Edit",function(a,b,Backbone,c,d,e){return a.Post=function(a){function b(){return b.__super__.constructor.apply(this,arguments)}return __extends(b,a),b.prototype.onRender=function(){return this.fillJSON(),this._setDate(),this._setActive(),this._setTags()},b.prototype._setDate=function(){var a,b;return b=this.model.get("publish_date"),e.isObject(b)&&(b=b.date),a=moment(b),this.$(".js-date").val(a.format("MMM Do YYYY, hh:mma")),this.$("#publish_date").val(a.format("MMM Do, YYYY h:mm A"))},b.prototype._setActive=function(){return 1===parseInt(this.model.get("active"))?(this.$(".publish").text(Lang.post_publish),this.$('input:radio[name="active"]').filter('[value="1"]').attr("checked",!0)):(this.$(".publish").text(Lang.post_save),this.$('input:radio[name="active"]').filter('[value="0"]').attr("checked",!0))},b.prototype._setTags=function(){var a;return a=e.pluck(this.model.get("tags"),"tag"),this.$("#js-tags").val(a)},b}(b.Views.PostView)});var __hasProp={}.hasOwnProperty,__extends=function(a,b){function c(){this.constructor=a}for(var d in b)__hasProp.call(b,d)&&(a[d]=b[d]);return c.prototype=b.prototype,a.prototype=new c,a.__super__=b.prototype,a};this.Cupboard.module("PostApp.List",function(a,b,Backbone,c,d,e){return a.Controller=function(c){function d(){return d.__super__.constructor.apply(this,arguments)}return __extends(d,c),d.prototype.initialize=function(){var a,c=this;return a=b.request("post:entities"),b.execute("when:fetched",a,function(){var b;return b=c.getListView(a),c.show(b),c.listenTo(b,"childview:post:delete:clicked",function(a,b){var c;return c=b.model,!!confirm(Lang.post_delete_confirm.replace("##post##",e.escape(c.get("title"))))&&c.destroy()})})},d.prototype.getListView=function(b){return new a.Posts({collection:b})},d}(b.Controllers.Base)});var __hasProp={}.hasOwnProperty,__extends=function(a,b){function c(){this.constructor=a}for(var d in b)__hasProp.call(b,d)&&(a[d]=b[d]);return c.prototype=b.prototype,a.prototype=new c,a.__super__=b.prototype,a};this.Cupboard.module("PostApp.List",function(a,b,Backbone,c,d,e){return a.PostItem=function(a){function c(){return c.__super__.constructor.apply(this,arguments)}return __extends(c,a),c.prototype.template="post/list/templates/item",c.prototype.tagName="tr",c.prototype.attributes=function(){return"1"===String(this.model.get("active"))&&this.model.get("publish_date")>moment().format("YYYY-MM-DD HH:mm:ss")?{"class":"post-item scheduled post-"+this.model.id}:"1"===String(this.model.get("active"))?{"class":"post-item published post-"+this.model.id}:{"class":"post-item draft post-"+this.model.id}},c.prototype.triggers={"click .delete":"post:delete:clicked"},c.prototype.events={"click .details":"edit","click .preview":"preview"},c.prototype.onShow=function(){var a,c,d;return c=b.request("get:all:users"),a=this.$(".avatar"),1===c.length?a.hide():(d=this.model.get("user"),a.avatar(d.email,a.attr("width"))),this.$(".js-format-date").formatDates()},c.prototype.templateHelpers={status:function(){return 1===parseInt(this.active)&&this.publish_date>moment().format("YYYY-MM-DD HH:mm:ss")?Lang.post_scheduled:1===parseInt(this.active)?Lang.post_active:Lang.post_draft}},c.prototype.edit=function(a){return a.preventDefault(),b.vent.trigger("post:item:clicked",this.model)},c.prototype.preview=function(a){var c;return a.preventDefault(),c=new Storage({id:this.model.id}),c.put(this.model.toJSON()),window.open(""+b.request("get:url:blog")+"/post/preview/"+this.model.id,"_blank")},c}(b.Views.ItemView),a.Empty=function(a){function b(){return b.__super__.constructor.apply(this,arguments)}return __extends(b,a),b.prototype.template="post/list/templates/empty",b.prototype.tagName="tr",b}(b.Views.ItemView),a.Posts=function(b){function c(){return c.__super__.constructor.apply(this,arguments)}return __extends(c,b),c.prototype.template="post/list/templates/grid",c.prototype.childView=a.PostItem,c.prototype.emptyView=a.Empty,c.prototype.childViewContainer="tbody",c.prototype.events={"click .js-filter":"filterPosts","keyup #js-filter":"search"},c.prototype.onCompositeCollectionRendered=function(){return this.doFilter("draft")},c.prototype.showEmpty=function(a){var b;if(!this.$("td:visible").length)return b=['"The scariest moment is always just before you start." ― Stephen King','"There is nothing to writing. All you do is sit down at a typewriter and bleed." ― Ernest Hemingway','"Start writing, no matter what. The water does not flow until the faucet is turned on." ―  Louis L\'Amour','"All you have to do is write one true sentence. Write the truest sentence that you know." ― Ernest Hemingway','"Being a writer is a very peculiar sort of a job: it\'s always you versus a blank sheet of paper (or a blank screen) and quite often the blank piece of paper wins." ― Neil Gaiman'],this.$("table").hide(),this.$(".js-quote").text(b[e.random(b.length-1)]),this.$(".no-posts").show().find("span").text(a)},c.prototype.hideAll=function(){return this.$el.find(".post-item").hide()},c.prototype.filterPosts=function(a){var b,c;return a.preventDefault(),this.$("table").show(),this.$(".no-posts").hide(),this.$("tr."+c).show(),b=d(a.currentTarget),c=b.data("type"),this.$(".page-header").find(".active").removeClass("active"),b.addClass("active"),this.doFilter(c)},c.prototype.doFilter=function(a){if(this.hideAll(),this.$("tr."+a).show(),0===this.$("tr."+a).length)return this.showEmpty(a)},c.prototype.search=function(a){return this.handleFilter()},c.prototype.handleFilter=function(){var a,b=this;return this.hideAll(),a=this.$("#js-filter").val(),""===a?this.$el.find(".post-item").show():this.collection.filter(function(c){return b.isMatch(c,a)})},c.prototype.isMatch=function(a,b){var c,d;if(d=new RegExp(b,"gi"),c=d.test(a.get("title")))return this.$el.find(".post-"+a.id).show()},c}(b.Views.CompositeView)});var __hasProp={}.hasOwnProperty,__extends=function(a,b){function c(){this.constructor=a}for(var d in b)__hasProp.call(b,d)&&(a[d]=b[d]);return c.prototype=b.prototype,a.prototype=new c,a.__super__=b.prototype,a};this.Cupboard.module("PostApp.New",function(a,b,Backbone,c,d,e){return a.Controller=function(c){function d(){return d.__super__.constructor.apply(this,arguments)}return __extends(d,c),d.prototype.initialize=function(a){var c,d,e=this;return c=b.request("new:post:entity"),this.storage=new Storage,this.listenTo(c,"created",function(){return e.storage.destroy(),b.vent.trigger("post:created",c)}),d=this.getNewView(c),this.show(d)},d.prototype.getNewView=function(b){return new a.Post({model:b,storage:this.storage})},d}(b.Controllers.Base)});var __hasProp={}.hasOwnProperty,__extends=function(a,b){function c(){this.constructor=a}for(var d in b)__hasProp.call(b,d)&&(a[d]=b[d]);return c.prototype=b.prototype,a.prototype=new c,a.__super__=b.prototype,a};this.Cupboard.module("PostApp.New",function(a,b,Backbone,c,d,e){return a.Post=function(a){function b(){return b.__super__.constructor.apply(this,arguments)}return __extends(b,a),b.prototype.onRender=function(){return this.fillJSON(d.jStorage.get("post-new")),this.$(".publish").text(Lang.post_publish),this.$("#date").attr("placeholder",moment().format("MMM Do, YYYY [9am]"))},b.prototype.fillForm=function(a){if(this.$("#slug").val(a.fields.slug),this.$("#title").val(a.fields.title),this.editor.codemirror.setValue(a.content),this.$("#publish_date").val(a.fields.date),a.fields.tags.length>0)return d("#js-tags").val(a.fields.tags.join())},b}(b.Views.PostView)});var __hasProp={}.hasOwnProperty,__extends=function(a,b){function c(){this.constructor=a}for(var d in b)__hasProp.call(b,d)&&(a[d]=b[d]);return c.prototype=b.prototype,a.prototype=new c,a.__super__=b.prototype,a};this.Cupboard.module("PostApp",function(a,b,Backbone,c,d,e){var f;return a.Router=function(a){function b(){return b.__super__.constructor.apply(this,arguments)}return __extends(b,a),b.prototype.appRoutes={"":"add",post:"list","post/add":"add","post/edit/:id":"edit"},b}(c.AppRouter),f={list:function(){return this.setActive(),new a.List.Controller},add:function(){return this.setActive(".write"),new a.New.Controller},edit:function(b,c){return this.setActive(),new a.Edit.Controller({id:b,post:c})},setActive:function(a){return null==a&&(a=".posts"),d("ul.nav li").removeClass("active").find(a).parent().addClass("active")}},b.vent.on("post:load",function(){return b.navigate("post"),f.list()}),b.vent.on("post:created post:updated",function(a){return d("#js-alert").showAlert(Lang.post_success,Lang.post_saved,"alert-success"),b.navigate("post/edit/"+a.id),f.edit(a.id,a)}),b.vent.on("post:new:clicked post:new",function(){return b.navigate("/",{trigger:!1}),f.add()}),b.vent.on("post:item:clicked",function(a){return b.navigate("post/edit/"+a.id),f.edit(a.id,a)}),b.addInitializer(function(){return new a.Router({controller:f})})});